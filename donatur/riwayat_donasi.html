<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Responsive Admin Template</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

    <link href="../assets/css/style.css" rel="stylesheet" />
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  </head>
  <body class="d-flex flex-column min-vh-100">
    <!-- Header fixed -->
    <header class="fixed-top shadow-sm">
      <!-- Branding Panel (Desktop) -->
      <div class="branding d-none d-lg-flex panel-header">
        <img src="https://sianas.aat.or.id/assets/images/logo_AAT.png" alt="Logo" />
        <span>Sistem Informasi Anak Asuh</span>
      </div>

      <!-- Navbar Desktop -->
      <nav class="navbar navbar-expand-lg px-3">
        <div class="container-fluid">
          <!-- LEFT MENU -->
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Beranda</a>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="donasiDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Donasi
              </a>
              <ul class="dropdown-menu" aria-labelledby="donasiDropdown">
                <li><h6 class="dropdown-header">Donasi Rutin</h6></li>
                <li><a class="dropdown-item" href="donasi_spp.html">SPP</a></li>
                <li><a class="dropdown-item" href="donasi_pt.html">Bantuan Pendidikan Tinggi</a></li>
                <li><a class="dropdown-item" href="donasi_opr.html">Operasional</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item" onclick="openPage('donasi_langsung')">Donasi Langsung</a></li>
                <li><a class="dropdown-item" href="riwayat_pembayaran_donasi.html">Pembayaran Donasi</a></li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Anak Asuh
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="anak_asuh.html">List Anak Asuh</a></li>
                <li><a class="dropdown-item" href="sekolah.html">List Sekolah</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item" href="bpt.html">List BPT</a></li>
                <li><a class="dropdown-item" href="pt.html">List Pendidikan Tinggi</a></li>
              </ul>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#rekeningYayasanModal"
                >Rekening Yayasan</a
              >
              <!-- <a class="nav-link" href="rekening-yayasan.html">Rekening Yayasan</a> -->
            </li>

            <li class="nav-item">
              <a class="nav-link" href="transfer-tak-dikenal.html">Transfer Tak Dikenal</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#kontakYayasanModal">Hubungi Kami</a>
            </li>
          </ul>

          <!-- RIGHT PROFILE & NOTIFICATION MENU -->
          <ul class="navbar-nav ms-auto align-items-center">
            <!-- ðŸ”” Notifikasi -->
            <li class="nav-item dropdown me-2">
              <a
                class="nav-link position-relative"
                href="#"
                id="notifDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-bell" style="font-size: 1.3rem"></i>
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"> 3 </span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notifDropdown">
                <li><h6 class="dropdown-header">Notifikasi</h6></li>
                <li><a class="dropdown-item small" href="#">Pembayaran donasi berhasil</a></li>
                <li><a class="dropdown-item small" href="#">SPP anak asuh sudah jatuh tempo</a></li>
                <li><a class="dropdown-item small" href="#">Laporan bulanan tersedia</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-center small text-primary" href="#">Lihat semua</a></li>
              </ul>
            </li>

            <!-- ðŸ‘¤ Profil -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle d-flex align-items-center"
                href="#"
                id="profileDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <img
                  src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
                  alt="User"
                  width="30"
                  height="30"
                  class="rounded-circle profile-img shadow-sm me-2"
                />
                <span class="fw-semibold ft-12">D-XX-XXXX</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                <li><a class="dropdown-item" href="profil.html">Profil</a></li>
                <li><a class="dropdown-item" href="ubah_password.html">Ubah Password</a></li>
                <li><a class="dropdown-item" href="riwayat_donasi.html">Riwayat Donasi</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-danger" href="#">Logout</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <!-- Navbar Mobile (atas) -->
    <nav class="fixed-top navbar navbar-dark bg-dark d-lg-none bg-aat">
      <div class="container-fluid">
        <button class="btn btn-outline-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar">
          <i class="bi bi-list"></i>
        </button>
        <span class="navbar-brand mx-auto">Beranda</span>
        <button class="btn btn-outline-light">
          <i class="bi bi-search"></i>
        </button>
      </div>
    </nav>

    <!-- Offcanvas Sidebar (Mobile) -->
    <div class="offcanvas offcanvas-start bg-dark text-white bg-aat" tabindex="-1" id="mobileSidebar">
      <!-- Header Sidebar -->
      <div class="offcanvas-header border-bottom">
        <div class="d-flex align-items-center">
          <img
            src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
            class="rounded-circle me-2 profile-img"
            alt="Logo"
            width="40"
            height="40"
          />
          <span class="fw-bold">Sistem Informasi Anak Asuh</span>
        </div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
      </div>

      <!-- Profil User -->
      <div class="p-4 border-bottom text-center bg-aat-grey bg-gradient text-black">
        <img
          src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
          class="rounded-circle profile-img"
          alt="User"
          width="80"
          height="80"
        />
        <h6 class="mb-0">Admin User</h6>
        <small class="mb-0">Administrator</small>
      </div>

      <!-- Body Sidebar -->
      <div class="offcanvas-body d-flex flex-column p-0">
        <!-- Menu scrollable -->
        <div class="list-group list-group-flush flex-grow-1 overflow-auto">
          <a href="index.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-house me-2"></i> Beranda
          </a>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#donasi"
          >
            <i class="bi bi-cash me-2"></i> Donasi <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="donasi">
            <a href="donasi_spp.html" class="list-group-item list-group-item-action bg-aat-grey ps-5">SPP</a>
            <a href="donasi_pt.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Bantuan Pendidikan Tinggi</a
            >
            <a href="donasi_opr.html" class="list-group-item list-group-item-action bg-aat-grey ps-5">Operasional</a>
            <a
              href="#"
              class="list-group-item list-group-item-action bg-aat-grey ps-5"
              onclick="openPage('donasi_langsung')"
              >Donasi Langsung</a
            >
            <a href="riwayat_pembayaran_donasi.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Pembayaran Donasi</a
            >
          </div>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#komunitas"
          >
            <i class="bi bi-person-lines-fill me-2"></i> Anak Asuh <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="komunitas">
            <a href="anak_asuh.html" class="list-group-item list-group-item-action bg-aat-grey ps-5">List Anak Asuh</a>
            <a href="sekolah.html" class="list-group-item list-group-item-action bg-aat-grey ps-5">List Sekolah</a>
            <a href="bpt.html" class="list-group-item list-group-item-action bg-aat-grey ps-5">List Anak BPT</a>
            <a href="#" class="list-group-item list-group-item-action bg-aat-grey ps-5">List Pendidikan Tinggi</a>
          </div>
          <a href="rekening-yayasan.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-wallet2 me-2"></i> Rekening Yayasan
          </a>
          <a href="transfer-tak-dikenal.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-receipt me-2"></i> Transfer Tak Dikenal
          </a>
          <a href="kontak.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-telephone me-2"></i> Hubungi Kami
          </a>
        </div>

        <!-- Footer Mobile -->
        <div class="p-3 border-top small text-center text-white d-lg-none">
          Â© Yayasan AAT Indonesia <br />
          Developed by <span class="fw-bold">Omah IT</span> <br />
          Maintained by <span class="fw-bold">Mandhira IT</span>
        </div>
      </div>
    </div>

    <!-- Bottom Navigation (Mobile) -->
    <div class="mobile-bottom-nav">
      <a href="index.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-house-fill fs-4"></i><br />
        <small>Beranda</small>
      </a>
      <a href="anak_asuh.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-person-lines-fill fs-4"></i><br />
        <small>Anak Asuh</small>
      </a>
      <a href="riwayat_pembayaran_donasi.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-receipt fs-4"></i><br />
        <small>Pembayaran</small>
      </a>
      <a href="profil.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-person-fill fs-4"></i><br />
        <small>Profil</small>
      </a>
    </div>

    <!-- Konten Utama -->
    <main class="container-fluid pt-3 pt-lg-5 pb-5 mt-5">
      <div class="d-none d-lg-block mb-5"></div>
      <h3 class="text-center page-title d-none d-lg-block">Riwayat Donasi</h3>
      <div class="mb-5"></div>
      <div class="layout">
        <div class="sidebar">
          <button class="sidebar-btn active" onclick="showData(event, '2024/2025')">Tahun Ajaran 2024/2025</button>
          <button class="sidebar-btn" onclick="showData(event, '2023/2024')">Tahun Ajaran 2023/2024</button>
          <button class="sidebar-btn" onclick="showData(event, '2022/2023')">Tahun Ajaran 2022/2023</button>
          <button class="sidebar-btn" onclick="showData(event, '2021/2022')">Tahun Ajaran 2021/2022</button>
          <button class="sidebar-btn" onclick="showData(event, '2020/2021')">Tahun Ajaran 2020/2021</button>
        </div>

        <div class="content" id="main-content"></div>
      </div>
    </main>
    <!-- Footer Desktop (sticky di bawah halaman) -->
    <footer class="fixed-bottom text-white text-center py-2 mt-auto d-none d-lg-block bg-aat">
      <small>
        Copyright Â© Yayasan AAT Indonesia | Developed by
        <span class="fw-bold">Omah IT - Gateway to Your IT Solutions</span> | Maintained by
        <span class="fw-bold">Mandhira IT</span>
        <br />
        Gunakan Browser <span class="fw-bold">Google Chrome</span> atau
        <span class="fw-bold">Mozilla Firefox</span> untuk tampilan terbaik.
        <div class="d-none d-lg-block mb-5"></div>
      </small>
    </footer>

    <!-- Modal -->
    <div
      class="modal fade"
      id="modalPembayaran"
      tabindex="-1"
      aria-labelledby="modalPembayaranLabel"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content rounded-4 border-0 shadow-lg">
          <div class="modal-header border-0 pb-0">
            <!-- <h5 class="modal-title fw-bold" id="modalPembayaranLabel">Detail Pembayaran Donasi</h5> -->
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <!-- Bagian Total -->
            <div class="row text-center mb-3 g-2">
              <div class="col-md-4 col-12">
                <div class="border rounded-3 p-2">
                  <p class="mb-1 fw-semibold text-secondary">Total Transfer</p>
                  <h5 class="fw-bold text-dark">Rp2.000.000</h5>
                </div>
              </div>
              <div class="col-md-4 col-12">
                <div class="border rounded-3 p-2">
                  <p class="mb-1 fw-semibold text-secondary">Total Donasi</p>
                  <h5 class="fw-bold text-dark">Rp8.100.000</h5>
                </div>
              </div>
              <div class="col-md-4 col-12">
                <div class="border rounded-3 p-2">
                  <p class="mb-1 fw-semibold text-secondary">
                    Sisa Donasi <span class="text-danger">(Kekurangan -)</span>
                  </p>
                  <h5 class="fw-bold text-danger">-Rp6.100.000</h5>
                </div>
              </div>
            </div>

            <!-- Besaran Transfer -->
            <div class="mb-3">
              <p class="fw-semibold mb-2">Rencana Besaran Transfer</p>
              <div class="d-flex flex-wrap gap-2">
                <button class="btn btn-outline-primary btn-sm fw-semibold" data-percent="100">100%</button>
                <button class="btn btn-outline-primary btn-sm fw-semibold" data-percent="75">75%</button>
                <button class="btn btn-outline-primary btn-sm fw-semibold" data-percent="50">50%</button>
                <button class="btn btn-outline-primary btn-sm fw-semibold" data-percent="25">25%</button>

                <div class="input-group input-group-sm w-auto">
                  <span class="input-group-text">Rp</span>
                  <input type="number" class="form-control" placeholder="Jumlah lainnya" id="customAmount" />
                </div>
              </div>
            </div>

            <!-- Metode Pembayaran -->
            <div class="mb-4">
              <p class="fw-semibold mb-2">Metode Pembayaran</p>
              <div class="d-flex flex-wrap gap-2">
                <button class="btn btn-outline-success fw-semibold payment-method" data-method="bca">Transfer BCA</button>
                <button class="btn btn-outline-warning fw-semibold payment-method" data-method="mandiri">Transfer Mandiri</button>
                <button class="btn btn-outline-info fw-semibold payment-method" data-method="qris">QRIS</button>
              </div>
            </div>

            <!-- Ringkasan Pembayaran -->
            <div class="rounded-4 p-2 text-white" style="background-color: #00aa55">
              <div class="d-flex justify-content-between small mb-1">
                <span>Subtotal <strong>Pembayaran</strong></span>
                <span id="subtotalPembayaran">Rp1.525.000</span>
              </div>
              <div class="d-flex justify-content-between small mb-1">
                <span>Kode Unik</span>
                <span id="kodeUnik">Rxxx</span>
              </div>
              <div class="d-flex justify-content-between align-items-center mt-2">
                <span class="fw-bold fs-5">Total <strong>Pembayaran</strong></span>
                <h4 class="fw-bold mb-0" id="totalPembayaran">Rp1.525.xxx</h4>
              </div>

              <div class="d-flex justify-content-end mt-3 gap-2">
                <button class="btn btn-warning fw-bold text-white">PEMBAYARAN</button>
                <button class="btn btn-danger fw-bold">Batalkan Transaksi</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/style.js"></script>

    <script>
      const data = {
        '2024/2025': {
          anak: 10,
          sd: 5,
          smp: 3,
          sma: 2,
          nominal: 'Rp8.100.000/tahun',
          transfer: 'Rp8.100.000',
          status: 'KEKURANGAN',
          spp: 'Rp675.000/bulan = Rp8.100.000/tahun',
        },
        '2023/2024': {
          anak: 8,
          sd: 3,
          smp: 3,
          sma: 2,
          nominal: 'Rp6.480.000/tahun',
          transfer: 'Rp6.480.000',
          status: 'LUNAS, Ada Kelebihan',
          spp: 'Rp540.000/bulan = Rp6.480.000/tahun',
        },
        '2022/2023': {
          anak: 8,
          sd: 3,
          smp: 3,
          sma: 2,
          nominal: 'Rp1.480.000/tahun',
          transfer: 'Rp6.480.000',
          status: 'LUNAS',
          spp: 'Rp540.000/bulan = Rp6.480.000/tahun',
        },
      };

      function showData(e, key) {
        const container = document.getElementById('main-content');
        const info = data[key] || data['2024/2025'];

        document.querySelectorAll('.sidebar-btn').forEach(btn => btn.classList.remove('active'));
        e.target.classList.add('active');

        console.log('Status: ' + info.status.includes('Ada kelebihan'));
        let buttonHTML = '';
        if (info.status === 'LUNAS, Ada Kelebihan') {
          buttonHTML = `<div class="summary-box mt-5">
                <hr>
                <button class="btn btn-primary btn-xl">Kirim Request Kelebihan TF ke TA Selanjutnya</button>
              </div>`;
        } else if (info.status === 'KEKURANGAN') {
          buttonHTML = `<div class="summary-box mt-5" data-bs-toggle="modal" data-bs-target="#modalPembayaran">
                <hr>
                <button class="btn btn-primary btn-xl">Bersedia Melunasi?</button>
              </div>`;
        }

        container.innerHTML = `
        <div class="fade-in">
          <div class="content-title">${key}</div>
          <div class="content-grid">
            <div class="content-left">
              <div class="section-header">Donasi SPP</div>
              <div class="main-value">${info.anak}</div>
              <div class="main-label">anak</div>

              <div class="bar-chart mb-4">
                <div class="bar-segment bar-sd">SD<br>${info.sd} anak</div>
                <div class="bar-segment bar-smp">SMP<br>${info.smp} anak</div>
                <div class="bar-segment bar-sma">SMA<br>${info.sma} anak</div>
              </div>

              <div class="section-desc">${info.spp}</div>

              <div class="info-box">Donasi Bantuan PT</div>
              <div class="not-found">Not Found</div>
              <div class="info-box">Donasi Operasional</div>
              <div class="not-found">Not Found</div>
            </div>

            <div class="divider"></div>

            <div class="content-right">
              <div class="summary-box summary-komitmen">
                <div>Total Komitmen</div>
                <div><b>${info.nominal}</b></div>
              </div>
              <div class="summary-box summary-transfer">
                <div>Total Transfer</div>
                <div><b>${info.transfer}</b></div>
              </div>
              <div class="summary-box summary-status">
                <div>Status Donasi</div>
                <span>${info.status}</span>
              </div>
              ${buttonHTML}
            </div>
          </div>
        </div>`;
      }

      // Tampilkan default
      showData({ target: document.querySelector('.sidebar-btn.active') }, '2024/2025');

      // Function to format number as Rupiah
      function formatRupiah(number) {
        return 'Rp' + number.toLocaleString('id-ID');
      }

      // Function to update subtotal and total pembayaran
      function updatePembayaran(amount) {
        const subtotalElement = document.getElementById('subtotalPembayaran');
        const totalElement = document.getElementById('totalPembayaran');
        const kodeUnikElement = document.getElementById('kodeUnik');

        // Calculate kode unik (random 3-digit number)
        const kodeUnik = Math.floor(Math.random() * 900) + 100;

        // Update subtotal
        subtotalElement.textContent = formatRupiah(amount);

        // Update kode unik
        kodeUnikElement.textContent = 'R' + kodeUnik;

        // Update total (subtotal + kode unik)
        const total = amount + kodeUnik;
        totalElement.textContent = formatRupiah(total);
      }

      // Event listeners for percentage buttons
      document.querySelectorAll('[data-percent]').forEach(button => {
        button.addEventListener('click', function() {
          const percent = parseInt(this.getAttribute('data-percent'));
          const sisaDonasi = 6100000; // Rp6.100.000 (hardcoded for now, can be dynamic)
          const amount = Math.round(sisaDonasi * (percent / 100));
          updatePembayaran(amount);
        });
      });

      // Event listener for custom amount input
      document.getElementById('customAmount').addEventListener('input', function() {
        const amount = parseInt(this.value) || 0;
        updatePembayaran(amount);
      });

      // Event listeners for percentage buttons to make them active
      document.querySelectorAll('[data-percent]').forEach(button => {
        button.addEventListener('click', function() {
          // Remove active class from all percentage buttons
          document.querySelectorAll('[data-percent]').forEach(btn => {
            btn.classList.remove('active');
            btn.classList.remove('btn-primary');
            btn.classList.add('btn-outline-primary');
          });
          // Add active class to clicked button
          this.classList.add('active');
          this.classList.remove('btn-outline-primary');
          this.classList.add('btn-primary');
        });
      });

      // Event listeners for payment method buttons to make them active
      document.querySelectorAll('.payment-method').forEach(button => {
        button.addEventListener('click', function() {
          // Remove active class from all payment method buttons
          document.querySelectorAll('.payment-method').forEach(btn => {
            btn.classList.remove('active');
            btn.classList.remove('btn-success', 'btn-warning', 'btn-info');
            btn.classList.add('btn-outline-success', 'btn-outline-warning', 'btn-outline-info');
          });
          // Add active class to clicked button
          this.classList.add('active');
          const method = this.getAttribute('data-method');
          if (method === 'bca') {
            this.classList.remove('btn-outline-success');
            this.classList.add('btn-success');
          } else if (method === 'mandiri') {
            this.classList.remove('btn-outline-warning');
            this.classList.add('btn-warning');
          } else if (method === 'qris') {
            this.classList.remove('btn-outline-info');
            this.classList.add('btn-info');
          }
        });
      });
    </script>
  </body>
</html>
