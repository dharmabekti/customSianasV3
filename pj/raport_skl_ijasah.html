<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Responsive Admin Template</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

    <link href="../assets/css/style.css" rel="stylesheet" />
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
  </head>
  <body class="d-flex flex-column min-vh-100">
    <!-- Header fixed -->
    <header class="fixed-top shadow-sm">
      <!-- Branding Panel (Desktop) -->
      <div class="branding d-none d-lg-flex panel-header">
        <img src="https://sianas.aat.or.id/assets/images/logo_AAT.png" alt="Logo" />
        <span>Sistem Informasi Anak Asuh</span>
      </div>

      <!-- Navbar Desktop -->
      <nav class="navbar navbar-expand-lg px-3">
        <div class="container-fluid">
          <!-- LEFT MENU -->
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Beranda</a>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Anak Asuh
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="anak_asuh.html">List Anak Asuh</a></li>
                <li class="dropdown-submenu">
                  <a class="dropdown-item" href="#">Input Anak Asuh</a>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="input_anak_asuh.html">Input Manual</a></li>
                    <li><a class="dropdown-item" href="import_anak_asuh.html">Import dari Excel</a></li>
                  </ul>
                </li>
                <li><a class="dropdown-item" href="raport_skl_ijasah.html">Raport, SKL, & Ijazah</a></li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >Komunitas/Sekolah
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="detail_komunitas.html">Detail Komunitas</a></li>
                <li><a class="dropdown-item" href="data_pj.html">Data Penanggungjawab</a></li>
                <li><a class="dropdown-item" href="input_pj.html">Input Penanggungjawab Baru</a></li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >Transfer Beasiswa
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="transfer_beasiswa.html">Data Transfer Beasiswa</a></li>
                <li><a class="dropdown-item" href="upload_kuitansi.html">Upload Kuitansi</a></li>
                <li><a class="dropdown-item" href="status_transfer.html">Status Transfer Beasiswa</a></li>
                <li><a class="dropdown-item" href="pengembalian_dana.html">Pengembalian Dana Berlebih</a></li>
                <li>
                  <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#rekeningYayasanModal"
                    >Rekening Yayasan</a
                  >
                </li>
              </ul>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#kontakYayasanModal">Hubungi Kami</a>
            </li>
          </ul>

          <!-- RIGHT PROFILE & NOTIFICATION MENU -->
          <ul class="navbar-nav ms-auto align-items-center">
            <!-- ðŸ”” Notifikasi -->
            <li class="nav-item dropdown me-2">
              <a
                class="nav-link position-relative"
                href="#"
                id="notifDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-bell" style="font-size: 1.3rem"></i>
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"> 3 </span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notifDropdown">
                <li><h6 class="dropdown-header">Notifikasi</h6></li>
                <li><a class="dropdown-item small" href="#">Pembayaran donasi berhasil</a></li>
                <li><a class="dropdown-item small" href="#">SPP anak asuh sudah jatuh tempo</a></li>
                <li><a class="dropdown-item small" href="#">Laporan bulanan tersedia</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-center small text-primary" href="#">Lihat semua</a></li>
              </ul>
            </li>

            <!-- ðŸ‘¤ Profil -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle d-flex align-items-center"
                href="#"
                id="profileDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <img
                  src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
                  alt="User"
                  width="30"
                  height="30"
                  class="rounded-circle profile-img shadow-sm me-2"
                />
                <span class="fw-semibold ft-12">PJ-XX-XXXX</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                <li><a class="dropdown-item" href="profil.html">Profil</a></li>
                <li><a class="dropdown-item" href="ubah_password.html">Ubah Password</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-danger" href="#">Logout</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <!-- Navbar Mobile (atas) -->
    <nav class="fixed-top navbar navbar-dark bg-dark d-lg-none bg-aat">
      <div class="container-fluid">
        <button class="btn btn-outline-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar">
          <i class="bi bi-list"></i>
        </button>
        <span class="navbar-brand mx-auto">Beranda</span>
        <div class="dropdown">
          <button
            class="btn btn-outline-light"
            type="button"
            id="mobileProfileDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <i class="bi bi-three-dots-vertical"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="mobileProfileDropdown">
            <li><a class="dropdown-item" href="profil.html">Profil</a></li>
            <li><a class="dropdown-item" href="ubah_password.html">Ubah Password</a></li>
            <li><hr class="dropdown-divider" /></li>
            <li><a class="dropdown-item text-danger" href="#">Logout</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Offcanvas Sidebar (Mobile) -->
    <div class="offcanvas offcanvas-start bg-dark text-white bg-aat" tabindex="-1" id="mobileSidebar">
      <!-- Header Sidebar -->
      <div class="offcanvas-header border-bottom">
        <div class="d-flex align-items-center">
          <img
            src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
            class="rounded-circle me-2 profile-img"
            alt="Logo"
            width="40"
            height="40"
          />
          <span class="fw-bold">Sistem Informasi Anak Asuh</span>
        </div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
      </div>

      <!-- Profil User -->
      <div class="p-4 border-bottom text-center bg-aat-grey bg-gradient text-black">
        <img
          src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
          class="rounded-circle profile-img"
          alt="User"
          width="80"
          height="80"
        />
        <h6 class="mb-0">
          Ki Anom Dharma Bekti
          <small class="mb-0">(PJ-XX-XXXX)</small>
        </h6>
        <small class="mb-0">SMA Dharma Bakti</small>
      </div>

      <!-- Body Sidebar -->
      <div class="offcanvas-body d-flex flex-column p-0">
        <!-- Menu scrollable -->
        <div class="list-group list-group-flush flex-grow-1 overflow-auto">
          <a href="index.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-house me-2"></i> Beranda
          </a>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#anakasuh"
          >
            <i class="bi bi-person-lines-fill me-2"></i> Anak Asuh <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="anakasuh">
            <a href="anak_asuh.html" class="list-group-item list-group-item-action bg-aat-grey ps-5">List Anak Asuh</a>
            <a href="naik_jenjang.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Pengajuan Naik Jenjang</a
            >
            <a href="raport.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Raport, SKL, & Ijazah</a
            >
          </div>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#komunitas"
          >
            <i class="bi bi-house-fill me-2"></i> Komunitas/Sekolah <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="komunitas">
            <a href="detail_komunitas.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Detail Komunitas</a
            >
            <a href="data_pj.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Data Penanggungjawab</a
            >
          </div>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#transferbeasiswa"
          >
            <i class="bi bi-receipt me-2"></i> Transfer Beasiswa <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="transferbeasiswa">
            <a href="transfer_beasiswa.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Data Transfer</a
            >
            <a href="pengembalian_dana.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Pengembalian Dana Berlebih</a
            >
          </div>
          <a href="rekening-yayasan.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-wallet2 me-2"></i> Rekening Yayasan
          </a>
        </div>

        <!-- Footer Mobile -->
        <div class="p-3 border-top small text-center text-white d-lg-none">
          Â© Yayasan AAT Indonesia <br />
          Developed by <span class="fw-bold">Omah IT</span> <br />
          Maintained by <span class="fw-bold">Mandhira IT</span>
        </div>
      </div>
    </div>

    <!-- Bottom Navigation (Mobile) -->
    <div class="mobile-bottom-nav">
      <a href="index.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-house-fill fs-4"></i><br />
        <small>Beranda</small>
      </a>
      <a href="anak_asuh.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-person-lines-fill fs-4"></i><br />
        <small>Anak Asuh</small>
      </a>
      <a href="transfer_beasiswa.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-receipt fs-4"></i><br />
        <small>Data Transfer</small>
      </a>
      <a href="raport_skl_ijasah.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-journal fs-4"></i><br />
        <small>Raport</small>
      </a>
    </div>

    <main class="container-fluid pt-3 pt-lg-5 pb-5 mt-5">
      <div class="d-none d-lg-block mb-5"></div>
      <h3 class="text-center page-title d-none d-lg-block">Raport, SKL, & Ijazah</h3>
      <div class="container-fluid mb-5 container-wrapper">
        <!-- âœ… Tombol Toggle Filter (Mobile) -->
        <div class="d-md-none mb-2">
          <button
            class="btn btn-outline-primary w-100"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#filterCollapse"
            aria-expanded="false"
            aria-controls="filterCollapse"
          >
            <i class="bi bi-funnel"></i> Tampilkan Filter
          </button>
        </div>

        <div class="row">
          <!-- âœ… FILTER -->
          <div class="col-md-2 mb-3">
            <div id="filterCollapse" class="collapse d-md-block">
              <div class="filter-section shadow-sm p-3 bg-white rounded ft-12">
                <label for="tahunAjaranFilter">Tahun Ajaran:</label>
                <select id="tahunAjaranFilter" class="form-select form-select-sm mb-2">
                  <option>2025/2026</option>
                  <option>2024/2025</option>
                  <option>2023/2024</option>
                </select>

                <label>Tingkat Sekolah:</label>
                <div class="form-check">
                  <input class="form-check-input tingkat" type="checkbox" value="SD" id="sd" />
                  <label class="form-check-label" for="sd">SD</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input tingkat" type="checkbox" value="SMP" id="smp" />
                  <label class="form-check-label" for="smp">SMP</label>
                </div>
                <div class="form-check mb-3">
                  <input class="form-check-input tingkat" type="checkbox" value="SMA" id="sma" />
                  <label class="form-check-label" for="sma">SMA</label>
                </div>
              </div>
            </div>
          </div>

          <!-- âœ… GRID ANAK ASUH -->
          <div class="col-md-10">
            <div class="table-responsive table-desktop">
              <table id="datatable" class="table table-bordered align-middle text-center bg-white shadow-sm">
                <thead class="table-light">
                  <tr>
                    <th>No</th>
                    <th>ID</th>
                    <th>Nama</th>
                    <th>Komunitas/Sekolah</th>
                    <th>Tahun Ajaran</th>
                    <th>Kelas</th>
                    <th>Raport Ganjil</th>
                    <th>Raport Genap</th>
                    <th>SKL</th>
                    <th>Ijazah</th>
                  </tr>
                </thead>
              </table>
            </div>
          </div>
        </div>

        <!-- âœ… CARD LIST UNTUK MOBILE -->
        <div class="card-mobile d-lg-none">
          <!-- ðŸ” PENCARIAN MOBILE -->
          <div class="input-group mb-3 shadow-sm">
            <span class="input-group-text bg-white border-end-0"><i class="bi bi-search"></i></span>
            <input type="text" id="searchCard" class="form-control border-start-0" placeholder="Cari anak asuh..." />
          </div>

          <!-- LIST CARD -->
          <div id="cardList" class="row g-2"></div>

          <!-- PAGINATION MOBILE -->
          <div class="d-flex justify-content-center mt-3">
            <nav><ul class="pagination" id="paginationMobile"></ul></nav>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer Desktop (sticky di bawah halaman) -->
    <footer class="fixed-bottom text-white text-center py-2 mt-auto d-none d-lg-block bg-aat">
      <small>
        Copyright Â© Yayasan AAT Indonesia | Developed by
        <span class="fw-bold">Omah IT - Gateway to Your IT Solutions</span> | Maintained by
        <span class="fw-bold">Mandhira IT</span>
        <br />
        Gunakan Browser <span class="fw-bold">Google Chrome</span> atau
        <span class="fw-bold">Mozilla Firefox</span> untuk tampilan terbaik.
        <div class="d-none d-lg-block mb-5"></div>
      </small>
    </footer>

    <!-- Modal Detail Raport -->
    <div
      class="modal fade"
      id="detailRaportModal"
      tabindex="-1"
      aria-labelledby="detailRaportLabel"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
    >
      <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content">
          <div class="modal-header bg-aat text-white">
            <h5 class="modal-title">Detail Raport Semester Ganjil</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <div class="info-section">
              <div class="row g-3">
                <!-- Kolom kiri -->
                <div class="col-12 col-md-12 info-column">
                  <div class="info-item">
                    <span class="info-label">ID</span>
                    <span class="info-value">24-00071</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Tahun Ajaran</span>
                    <span class="info-value">2025/2026</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Nama Lengkap</span>
                    <span class="info-value">Antonio Veejay Alhdhir</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Komunitas/Sekolah</span>
                    <span class="info-value">SMK Kristen 2 Magelang</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Kelas</span>
                    <span class="info-value">SMA/SMK Kelas 12</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Semester</span>
                    <span class="info-value">Gasal</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Tahun Ajaran</span>
                    <span class="info-value">2025/2026</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">File</span>
                    <span class="info-value"><a href="#">24-00071.pdf</a></span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Status</span>
                    <span class="badge bg-danger">Rejected</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Catatan</span>
                    <span class="info-value">File tidak lengkap, ada halaman yang blur</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer justify-content-center">
            <button type="button" class="btn btn-warning px-4 fw-bold text-white" data-bs-dismiss="modal">
              <i class="bi bi-pen me-1"></i> Revisi
            </button>
            <button type="button" class="btn btn-primary px-4 fw-bold" data-bs-dismiss="modal">
              <i class="bi bi-arrow-left me-1"></i> Kembali
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Upload Raport -->
    <div
      class="modal fade"
      id="uploadRaportModal"
      tabindex="-1"
      aria-labelledby="uploadRaportLabel"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
    >
      <div class="modal-dialog modal-dialog-centered modal-wide">
        <div class="modal-content">
          <div class="modal-header bg-aat text-white">
            <h5 class="modal-title">Input Raport Semester Ganjil</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <div class="info-section">
              <div class="row g-3">
                <!-- Kolom kiri -->
                <div class="col-12 col-md-12 info-column">
                  <div class="info-item">
                    <span class="info-label">ID</span>
                    <span class="info-value">24-00071</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Tahun Ajaran</span>
                    <span class="info-value">2025/2026</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Nama Lengkap</span>
                    <span class="info-value">Antonio Veejay Alhdhir</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Komunitas/Sekolah</span>
                    <span class="info-value">SMK Kristen 2 Magelang</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Kelas</span>
                    <span class="info-value">SMA/SMK Kelas 12</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Semester</span>
                    <span class="info-value">Gasal</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Tahun Ajaran</span>
                    <span class="info-value">2025/2026</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">File <sup class="text-important">*)</sup></span>
                    <div class="col-sm-8 d-flex gap-2">
                      <input type="file" class="form-control form-control-sm" />
                    </div>
                  </div>
                  <small class="text-important">*) Wajib Diisi</small>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer justify-content-center">
            <button type="button" class="btn btn-success px-4 fw-bold" data-bs-dismiss="modal">
              <i class="bi bi-check me-1"></i> Upload
            </button>
            <button type="button" class="btn btn-primary px-4 fw-bold" data-bs-dismiss="modal">
              <i class="bi bi-arrow-left me-1"></i> Kembali
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Upload Ijasah -->
    <div
      class="modal fade"
      id="uploadIjasahModal"
      tabindex="-1"
      aria-labelledby="uploadIjasahLabel"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
    >
      <div class="modal-dialog modal-dialog-centered modal-wide">
        <div class="modal-content">
          <div class="modal-header bg-aat text-white">
            <h5 class="modal-title">Input Ijasah</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <div class="info-section">
              <div class="row g-3">
                <!-- Kolom kiri -->
                <div class="col-12 col-md-12 info-column">
                  <div class="info-item">
                    <span class="info-label">ID</span>
                    <span class="info-value">24-00071</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Nama Lengkap</span>
                    <span class="info-value">Antonio Veejay Alhdhir</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Komunitas/Sekolah</span>
                    <span class="info-value">SMK Kristen 2 Magelang</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Tingkat Pendidikan</span>
                    <span class="info-value">SMA/SMK</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Nama Sekolah <sup class="text-important">*)</sup></span>
                    <input type="text" class="form-control form-control-sm" required />
                  </div>
                  <div class="info-item">
                    <span class="info-label">Jurusan <sup class="text-important">*)</sup></span>
                    <input type="text" class="form-control form-control-sm" required />
                  </div>
                  <div class="row">
                    <div class="col-6">
                      <div class="info-item">
                        <span class="info-label">Tahun Masuk <sup class="text-important">*)</sup></span>
                        <input type="number" class="form-control form-control-sm" value="2022" required />
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="info-item">
                        <span class="info-label">Tahun Lulus <sup class="text-important">*)</sup></span>
                        <input type="number" class="form-control form-control-sm" value="2025" required />
                      </div>
                    </div>
                  </div>
                  <div class="info-item">
                    <span class="info-label">File <sup class="text-important">*)</sup></span>
                    <div class="col-sm-9 d-flex gap-2">
                      <input type="file" class="form-control form-control-sm" />
                    </div>
                  </div>
                  <small class="text-important">*) Wajib Diisi</small>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer justify-content-center">
            <button type="button" class="btn btn-success px-4 fw-bold" data-bs-dismiss="modal">
              <i class="bi bi-check me-1"></i> Upload
            </button>
            <button type="button" class="btn btn-primary px-4 fw-bold" data-bs-dismiss="modal">
              <i class="bi bi-arrow-left me-1"></i> Kembali
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/style.js"></script>

    <script>
      // ===============================
      // Daftar Nama Anak Asuh
      // ===============================
      const namaList = [
        'Ahmad Fauzi',
        'Budi Santoso',
        'Citra Dewi',
        'Dedi Rahman',
        'Eka Sari',
        'Fajar Nugroho',
        'Gita Permata',
        'Hadi Wijaya',
        'Indah Lestari',
        'Joko Susilo',
        'Kartika Sari',
        'Lutfi Hakim',
        'Maya Sari',
        'Nanda Putra',
        'Oka Wibowo',
        'Putri Ayu',
        'Rudi Hartono',
        'Sari Indah',
        'Taufik Rahman',
        'Umi Kalsum',
        'Vina Sari',
        'Wahyu Nugroho',
        'Yuniarti',
        'Zainal Abidin',
        'Ani Suryani',
        'Bambang Setiawan',
        'Cici Handayani',
        'Dian Purnama',
        'Eko Prasetyo',
        'Fina Sari',
      ];

      const sekolahList = [
        'SD Dharma Bakti 1',
        'SD Dharma Bakti 2',
        'SMP Dharma Bakti',
        'SMA Dharma Bakti',
        'SD Islam Terpadu',
        'SMP Islam Terpadu',
        'SMA Islam Terpadu',
        'SD Negeri 1',
        'SMP Negeri 1',
        'SMA Negeri 1',
      ];

      const tahunAjaranList = ['2023/2024', '2024/2025', '2025/2026'];
      const tingkatList = ['SD', 'SMP', 'SMA'];
      const fileStatusList = ['Belum Upload', 'Waiting', 'Approved', 'Rejected', 'Done'];

      // ===============================
      // Generate Data Anak Asuh
      // ===============================
      const anakAsuhData = Array.from({ length: 50 }, (_, i) => {
        const nama = namaList[Math.floor(Math.random() * namaList.length)];
        const sekolah = sekolahList[Math.floor(Math.random() * sekolahList.length)];
        const tahunAjaran = tahunAjaranList[Math.floor(Math.random() * tahunAjaranList.length)];
        const tingkat = tingkatList[Math.floor(Math.random() * tingkatList.length)];
        let kelas;
        if (tingkat === 'SD') kelas = Math.floor(Math.random() * 6) + 1;
        else if (tingkat === 'SMP') kelas = Math.floor(Math.random() * 3) + 7;
        else kelas = Math.floor(Math.random() * 3) + 10;

        return {
          no: i + 1,
          id: `AA-${String(i + 1).padStart(4, '0')}`,
          nama,
          sekolah,
          tahunAjaran,
          tingkat,
          kelas,
          raportGanjil: fileStatusList[Math.floor(Math.random() * fileStatusList.length)],
          raportGenap: fileStatusList[Math.floor(Math.random() * fileStatusList.length)],
          skl: fileStatusList[Math.floor(Math.random() * fileStatusList.length)],
          ijazah: fileStatusList[Math.floor(Math.random() * fileStatusList.length)],
        };
      });

      const cardList = document.getElementById('cardList');
      const searchCard = document.getElementById('searchCard');
      const paginationMobile = document.getElementById('paginationMobile');

      // Filter elements
      const tahunAjaranFilter = document.getElementById('tahunAjaranFilter');
      const tingkatCheckboxes = document.querySelectorAll('.tingkat');

      let currentPageMobile = 1;
      const perPageMobile = 6;

      // ===============================
      // Helper: Warna badge file
      // ===============================
      function getFileBadgeClass(fileStatus) {
        const status = fileStatus.toLowerCase();
        if (status === 'done') return 'success';
        if (status === 'approved') return 'info';
        if (status === 'waiting') return 'warning';
        if (status === 'rejected') return 'danger';
        return 'secondary'; // for 'belum upload', 'belum upload'
      }

      // ===============================
      // Get selected tingkat
      // ===============================
      function getSelectedTingkat(checkboxes) {
        return Array.from(checkboxes)
          .filter(cb => cb.checked)
          .map(cb => cb.value);
      }

      // ===============================
      // Filter data
      // ===============================
      function filterData(data, tahunAjaran, selectedTingkat) {
        return data.filter(item => {
          const tahunMatch = tahunAjaran === '' || item.tahunAjaran === tahunAjaran;
          const tingkatMatch = selectedTingkat.length === 0 || selectedTingkat.includes(item.tingkat);
          return tahunMatch && tingkatMatch;
        });
      }

      // ===============================
      // Initialize DataTable (Desktop) - once only
      // ===============================
      let dataTable; // Global variable to hold DataTable instance

      function initDataTable() {
        dataTable = $('#datatable').DataTable({
          data: anakAsuhData,
          columns: [
            { data: 'no' },
            { data: 'id' },
            { data: 'nama' },
            { data: 'sekolah' },
            { data: 'tahunAjaran' },
            { data: 'kelas' },
            {
              data: 'raportGanjil',
              render: function (data) {
                return `<span class="badge bg-${getFileBadgeClass(
                  data
                )}" data-bs-toggle="modal" data-bs-target="#uploadRaportModal">${data}</span>`;
              },
            },
            {
              data: 'raportGenap',
              render: function (data) {
                return `<span class="badge bg-${getFileBadgeClass(
                  data
                )}" data-bs-toggle="modal" data-bs-target="#detailRaportModal">${data}</span>`;
              },
            },
            {
              data: 'skl',
              render: function (data) {
                return `<span class="badge bg-${getFileBadgeClass(data)}">${data}</span>`;
              },
            },
            {
              data: 'ijazah',
              render: function (data) {
                return `<span class="badge bg-${getFileBadgeClass(
                  data
                )}" data-bs-toggle="modal" data-bs-target="#uploadIjasahModal">${data}</span>`;
              },
            },
            { data: 'tingkat', visible: false }, // Hidden column for filtering
          ],
          language: {
            url: 'https://cdn.datatables.net/plug-ins/1.13.6/i18n/id.json',
          },
          pageLength: 10,
          lengthMenu: [
            [10, 15, 20, -1],
            [10, 15, 20, 'Semua'],
          ],
          ordering: true,
        });
      }

      // ===============================
      // Filter DataTable using API (no destroy/recreate)
      // ===============================
      function filterTable() {
        const tahunAjaran = tahunAjaranFilter.value;
        const selectedTingkat = getSelectedTingkat(tingkatCheckboxes);

        // Filter by tahun ajaran
        dataTable.column(4).search(tahunAjaran).draw();

        // Filter by tingkat using custom filter
        $.fn.dataTable.ext.search.push(function (settings, data, dataIndex) {
          if (selectedTingkat.length === 0) return true;
          return selectedTingkat.includes(data[10]); // Index 10 is the hidden tingkat column
        });
        dataTable.draw();
        $.fn.dataTable.ext.search.pop(); // Remove the custom filter after draw
      }

      // ===============================
      // Render Cards (Mobile)
      // ===============================
      function renderCards() {
        const searchTerm = searchCard.value.toLowerCase();
        const isMobile = window.innerWidth < 992;
        const tahunAjaran = isMobile ? document.getElementById('tahunAjaranFilter').value : tahunAjaranFilter.value;
        const selectedTingkat = getSelectedTingkat(tingkatCheckboxes);

        let filtered = filterData(anakAsuhData, tahunAjaran, selectedTingkat);

        // Apply search
        if (searchTerm) {
          filtered = filtered.filter(
            item =>
              item.nama.toLowerCase().includes(searchTerm) ||
              item.sekolah.toLowerCase().includes(searchTerm) ||
              item.id.toLowerCase().includes(searchTerm)
          );
        }

        const totalPages = Math.ceil(filtered.length / perPageMobile);
        if (currentPageMobile > totalPages) currentPageMobile = totalPages || 1;

        const start = (currentPageMobile - 1) * perPageMobile;
        const paginated = filtered.slice(start, start + perPageMobile);

        cardList.innerHTML = paginated
          .map(
            item => `
      <div class="col-12">
        <div class="card shadow-sm p-3 mb-2">
          <h5 class="card-title">${item.nama}</h5>
          <p class="mb-1"><strong>ID:</strong> ${item.id}</p>
          <p class="mb-1"><strong>Sekolah:</strong> ${item.sekolah}</p>
          <p class="mb-1"><strong>Tahun Ajaran:</strong> ${item.tahunAjaran}</p>
          <p class="mb-1"><strong>Kelas:</strong> ${item.kelas}</p>
          <p class="mb-1" data-bs-toggle="modal" data-bs-target="#uploadRaportModal"><strong>Raport Ganjil:</strong> <span class="badge bg-${getFileBadgeClass(
            item.raportGanjil
          )}">${item.raportGanjil}</span></p>
          <p class="mb-1" data-bs-toggle="modal" data-bs-target="#detailRaportModal"><strong>Raport Genap:</strong> <span class="badge bg-${getFileBadgeClass(
            item.raportGenap
          )}">${item.raportGenap}</span></p>
          <p class="mb-1"><strong>SKL:</strong> <span class="badge bg-${getFileBadgeClass(item.skl)}">${
              item.skl
            }</span></p>
          <p class="mb-1" data-bs-toggle="modal" data-bs-target="#uploadIjasahModal"><strong>Ijazah:</strong> <span class="badge bg-${getFileBadgeClass(
            item.ijazah
          )}">${item.ijazah}</span></p>
        </div>
      </div>
    `
          )
          .join('');

        // Pagination
        paginationMobile.innerHTML =
          totalPages > 1
            ? Array.from(
                { length: totalPages },
                (_, i) => `
            <li class="page-item ${i + 1 === currentPageMobile ? 'active' : ''}">
              <a class="page-link" href="#" data-page="${i + 1}">${i + 1}</a>
            </li>
          `
              ).join('')
            : '';

        paginationMobile.querySelectorAll('.page-link').forEach(link => {
          link.addEventListener('click', e => {
            e.preventDefault();
            const page = parseInt(e.target.dataset.page);
            if (page && page !== currentPageMobile) {
              currentPageMobile = page;
              renderCards();
            }
          });
        });
      }

      // ===============================
      // Event Listener
      // ===============================
      searchCard.addEventListener('input', () => {
        currentPageMobile = 1;
        renderCards();
      });

      tahunAjaranFilter.addEventListener('change', () => {
        currentPageMobile = 1;
        renderCards();
      });

      tingkatCheckboxes.forEach(cb => {
        cb.addEventListener('change', () => {
          currentPageMobile = 1;
          renderCards();
        });
      });

      // ===============================
      // Inisialisasi Awal
      // ===============================
      renderCards();

      // ===============================
      // DataTable (Desktop) - Initialize once, filter dynamically
      // ===============================
      $(document).ready(function () {
        if (window.innerWidth >= 992) {
          initDataTable();
        }
      });

      // ===============================
      // Event Listener for Desktop Filters - Use filterTable to avoid flickering
      // ===============================
      tahunAjaranFilter.addEventListener('change', filterTable);
      tingkatCheckboxes.forEach(cb => cb.addEventListener('change', filterTable));
    </script>
  </body>
</html>
