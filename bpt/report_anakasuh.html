<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Responsive Admin Template</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

    <link href="../assets/css/style.css" rel="stylesheet" />
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  </head>
  <body class="d-flex flex-column min-vh-100">
    <!-- Header fixed -->
    <header class="fixed-top shadow-sm">
      <!-- Branding Panel (Desktop) -->
      <div class="branding d-none d-lg-flex panel-header">
        <img src="https://sianas.aat.or.id/assets/images/logo_AAT.png" alt="Logo" />
        <span>Sistem Informasi Anak Asuh</span>
      </div>

      <!-- Navbar Desktop -->
      <nav class="navbar navbar-expand-lg px-3">
        <div class="container-fluid">
          <!-- LEFT MENU -->
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Beranda</a>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Anak Asuh
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="anak_asuh.html">List Anak Asuh</a></li>
                <li class="dropdown-submenu">
                  <a class="dropdown-item" href="#">Input Anak Asuh</a>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="input_anak_asuh.html">Input Manual</a></li>
                    <li><a class="dropdown-item" href="import_anak_asuh.html">Import dari Excel</a></li>
                  </ul>
                </li>
                <li><a class="dropdown-item" href="raport_skl_ijasah.html">Raport, SKL, & Ijazah</a></li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >Komunitas/Sekolah
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="sekolah.html">Data Komunitas/Sekolah</a></li>
                <li><a class="dropdown-item" href="data_pj.html">Data Penanggungjawab</a></li>
                <li><a class="dropdown-item" href="input_pj.html">Input Penanggungjawab Baru</a></li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >Transfer Beasiswa
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="transfer_beasiswa.html">Data Transfer Beasiswa</a></li>
                <li><a class="dropdown-item" href="status_transfer.html">Status Transfer Beasiswa</a></li>
                <li><a class="dropdown-item" href="pengembalian_dana.html">Pengembalian Dana Berlebih</a></li>
                <li>
                  <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#rekeningYayasanModal"
                    >Rekening Yayasan</a
                  >
                </li>
              </ul>
            </li>

            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="anakAsuhDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >Laporan
              </a>
              <ul class="dropdown-menu" aria-labelledby="anakAsuhDropdown">
                <li><a class="dropdown-item" href="report_anakasuh.html">Laporan Anak Asuh</a></li>
                <li><a class="dropdown-item" href="report_sekolah.html">Laporan Komunitas/Sekolah</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item" href="data_statistik.html">Data & Statistik</a></li>
              </ul>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#kontakYayasanModal">Hubungi Kami</a>
            </li>
          </ul>

          <!-- RIGHT PROFILE & NOTIFICATION MENU -->
          <ul class="navbar-nav ms-auto align-items-center">
            <!-- ðŸ”” Notifikasi -->
            <li class="nav-item dropdown me-2">
              <a
                class="nav-link position-relative"
                href="#"
                id="notifDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-bell" style="font-size: 1.3rem"></i>
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"> 3 </span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notifDropdown">
                <li><h6 class="dropdown-header">Notifikasi</h6></li>
                <li><a class="dropdown-item small" href="#">Pembayaran donasi berhasil</a></li>
                <li><a class="dropdown-item small" href="#">SPP anak asuh sudah jatuh tempo</a></li>
                <li><a class="dropdown-item small" href="#">Laporan bulanan tersedia</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-center small text-primary" href="#">Lihat semua</a></li>
              </ul>
            </li>

            <!-- ðŸ‘¤ Profil -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle d-flex align-items-center"
                href="#"
                id="profileDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <img
                  src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
                  alt="User"
                  width="30"
                  height="30"
                  class="rounded-circle profile-img shadow-sm me-2"
                />
                <span class="fw-semibold ft-12">BPT-XX-XXXX</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                <li><a class="dropdown-item" href="profil.html">Profil</a></li>
                <li><a class="dropdown-item" href="ubah_password.html">Ubah Password</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-danger" href="#">Logout</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <!-- Navbar Mobile (atas) -->
    <nav class="fixed-top navbar navbar-dark bg-dark d-lg-none bg-aat">
      <div class="container-fluid">
        <button class="btn btn-outline-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar">
          <i class="bi bi-list"></i>
        </button>
        <span class="navbar-brand mx-auto">Laporan Anak Asuh</span>
        <div class="dropdown">
          <button
            class="btn btn-outline-light"
            type="button"
            id="mobileProfileDropdown"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <i class="bi bi-three-dots-vertical"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="mobileProfileDropdown">
            <li><a class="dropdown-item" href="profil.html">Profil</a></li>
            <li><a class="dropdown-item" href="ubah_password.html">Ubah Password</a></li>
            <li><hr class="dropdown-divider" /></li>
            <li><a class="dropdown-item text-danger" href="#">Logout</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Offcanvas Sidebar (Mobile) -->
    <div class="offcanvas offcanvas-start bg-dark text-white bg-aat" tabindex="-1" id="mobileSidebar">
      <!-- Header Sidebar -->
      <div class="offcanvas-header border-bottom">
        <div class="d-flex align-items-center">
          <img
            src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
            class="rounded-circle me-2 profile-img"
            alt="Logo"
            width="40"
            height="40"
          />
          <span class="fw-bold">Sistem Informasi Anak Asuh</span>
        </div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
      </div>

      <!-- Profil User -->
      <div class="p-4 border-bottom text-center bg-aat-grey bg-gradient text-black">
        <img
          src="https://sianas.aat.or.id/assets/images/logo_AAT.png"
          class="rounded-circle profile-img"
          alt="User"
          width="80"
          height="80"
        />
        <h6 class="mt-1">Ki Anom</h6>
        <small class="mb-0">BPT-XX-XXXX</small><br />
        <small class="mb-0">Sekretariat Yogyakarta</small>
      </div>

      <!-- Body Sidebar -->
      <div class="offcanvas-body d-flex flex-column p-0">
        <!-- Menu scrollable -->
        <div class="list-group list-group-flush flex-grow-1 overflow-auto">
          <a href="index.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-house me-2"></i> Beranda
          </a>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#anakasuh"
          >
            <i class="bi bi-person-lines-fill me-2"></i> Anak Asuh <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="anakasuh">
            <a href="anak_asuh.html" class="list-group-item list-group-item-action bg-aat-grey ps-5">List Anak Asuh</a>
            <a href="raport.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Raport, SKL, & Ijazah</a
            >
          </div>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#komunitas"
          >
            <i class="bi bi-house-fill me-2"></i> Komunitas/Sekolah <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="komunitas">
            <a href="sekolah.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Data Komunitas/Sekolah</a
            >
            <a href="data_pj.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Data Penanggungjawab</a
            >
          </div>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#transferbeasiswa"
          >
            <i class="bi bi-receipt me-2"></i> Transfer Beasiswa <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="transferbeasiswa">
            <a href="transfer_beasiswa.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Data Transfer</a
            >
            <a href="pengembalian_dana.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Pengembalian Dana Berlebih</a
            >
          </div>
          <a
            href="#"
            class="list-group-item list-group-item-action bg-aat text-white"
            data-bs-toggle="collapse"
            data-bs-target="#laporan"
          >
            <i class="bi bi-journal-text me-2"></i> Laporan <i class="bi bi-chevron-down float-end"></i>
          </a>
          <div class="collapse" id="laporan">
            <a href="report_anakasuh.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Laporan Anak Asuh</a
            >
            <a href="report_sekolah.html" class="list-group-item list-group-item-action bg-aat-grey ps-5"
              >Laporan Komunitas/Sekolah</a
            >
          </div>
          <a href="rekening-yayasan.html" class="list-group-item list-group-item-action bg-aat text-white">
            <i class="bi bi-wallet2 me-2"></i> Rekening Yayasan
          </a>
        </div>

        <!-- Footer Mobile -->
        <div class="p-3 border-top small text-center text-white d-lg-none">
          Â© Yayasan AAT Indonesia <br />
          Developed by <span class="fw-bold">Omah IT</span> <br />
          Maintained by <span class="fw-bold">Mandhira IT</span>
        </div>
      </div>
    </div>

    <!-- Bottom Navigation (Mobile) -->
    <div class="mobile-bottom-nav">
      <a href="index.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-house-fill fs-4"></i><br />
        <small>Beranda</small>
      </a>
      <a href="data_sekolah.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-house-fill fs-4"></i><br />
        <small>Sekolah</small>
      </a>
      <a href="transfer_beasiswa.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-receipt fs-4"></i><br />
        <small>Data Transfer</small>
      </a>
      <a href="raport_skl_ijasah.html" class="text-dark text-center text-decoration-none">
        <i class="bi bi-journal fs-4"></i><br />
        <small>Raport</small>
      </a>
    </div>

    <main class="container-fluid pt-3 pt-lg-5 pb-5 mt-5">
      <div class="d-none d-lg-block mb-5"></div>
      <h3 class="text-center page-title d-none d-lg-block">Laporan Anak Asuh</h3>
      <div class="container-fluid form-wrapper">
        <div class="mb-3">
          <button
            class="btn btn-outline-primary w-100 d-lg-none"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#unifiedFilters"
            aria-expanded="false"
            aria-controls="unifiedFilters"
          >
            <i class="bi bi-funnel me-2"></i>Filter Data
          </button>

          <!-- Elemen collapse TIDAK boleh memakai d-flex -->
          <div class="collapse mt-2 mt-lg-0" id="unifiedFilters">
            <!-- Layout wrapper baru -->
            <div class="filter-bar d-flex flex-column flex-lg-row gap-1 gap-lg-0">
              <div class="d-flex flex-column flex-lg-row align-items-start align-items-lg-center gap-1 gap-lg-2 w-100">
                <label for="sekolahFilter" class="form-label mb-0 fw-semibold">Komunitas:</label>
                <select id="sekolahFilter" class="form-select form-select-sm" style="width: 180px;">
                  <option value="">Semua Komunitas</option>
                </select>

                <label for="statusFilter" class="form-label mb-0 fw-semibold">Status:</label>
                <select id="statusFilter" class="form-select form-select-sm" style="width: 180px;">
                  <option value="">Semua Status</option>
                  <option>Naik Kelas</option>
                  <option>Tidak Naik Kelas</option>
                </select>

                <label for="tingkatFilter" class="form-label mb-0 fw-semibold">Pendidikan:</label>
                <select id="tingkatFilter" class="form-select form-select-sm" style="width: 180px;">
                  <option value="">Semua Tingkat</option>
                  <option>SD</option>
                  <option>SMP</option>
                  <option>SMA</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- âœ… TABLE FOR DESKTOP -->
        <div class="table-responsive table-desktop">
          <table id="datatable" class="table table-bordered align-middle text-center bg-white shadow-sm">
            <thead class="table-light">
              <tr>
                <th>No</th>
                <th>ID</th>
                <th>Nama</th>
                <th>Komunitas/Sekolah</th>
                <th>Kelas</th>
                <th>Status</th>
                <th>SPP Tahun Ajaran Ini</th>
                <th>Status SPP</th>
                <th>Donatur</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <!-- âœ… CARD LIST UNTUK MOBILE -->
        <div class="card-mobile d-lg-none">
          <!-- ðŸ” PENCARIAN MOBILE -->
          <div class="input-group mb-3 shadow-sm">
            <span class="input-group-text bg-white border-end-0"><i class="bi bi-search"></i></span>
            <input type="text" id="searchCard" class="form-control border-start-0" placeholder="Cari anak asuh..." />
          </div>

          <!-- LIST CARD -->
          <div id="cardList" class="row g-2"></div>

          <!-- PAGINATION MOBILE -->
          <div class="d-flex justify-content-center mt-3">
            <nav><ul class="pagination" id="paginationMobile"></ul></nav>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer Desktop (sticky di bawah halaman) -->
    <footer class="fixed-bottom text-white text-center py-2 mt-auto d-none d-lg-block bg-aat">
      <small>
        Copyright Â© Yayasan AAT Indonesia | Developed by
        <span class="fw-bold">Omah IT - Gateway to Your IT Solutions</span> | Maintained by
        <span class="fw-bold">Mandhira IT</span>
        <br />
        Gunakan Browser <span class="fw-bold">Google Chrome</span> atau
        <span class="fw-bold">Mozilla Firefox</span> untuk tampilan terbaik.
        <div class="d-none d-lg-block mb-5"></div>
      </small>
    </footer>

    <!-- Modal Detail Data Transfer -->
    <div
      class="modal fade"
      id="detailTransferModal"
      tabindex="-1"
      aria-labelledby="detailTransferLabel"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
    >
      <div class="modal-dialog modal-dialog-centered modal-wide">
        <div class="modal-content">
          <div class="modal-header bg-aat text-white">
            <h5 class="modal-title">Detail Data Transfer Beasiswa</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <div class="info-section">
              <div class="row g-3">
                <!-- Kolom kiri -->
                <div class="col-12 col-md-6 info-column">
                  <div class="info-item">
                    <span class="info-label">ID SPP</span>
                    <span class="info-value">20xxx</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Tahun Ajaran</span>
                    <span class="info-value">2025/2026</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Komunitas</span>
                    <span class="info-value">SMK Kristen 2 Magelang</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Bulan</span>
                    <span class="info-value">Desember</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Uraian</span>
                    <span class="info-value">â€”</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Kuitansi</span>
                    <a href="#" class="info-value text-primary text-decoration-none"> kuitansi_K-14-0209_20704.pdf </a>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Lampiran Kuitansi</span>
                    <a href="#" class="info-value text-primary text-decoration-none">
                      lamp_kuitansi_K-14-0209_20704.pdf
                    </a>
                  </div>
                </div>

                <!-- Kolom kanan -->
                <div class="col-12 col-md-6 info-column">
                  <div class="info-item">
                    <span class="info-label">Tanggal Transfer</span>
                    <span class="info-value">-</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Kode Transfer</span>
                    <span class="info-value">-</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Bank Tujuan</span>
                    <span class="info-value">BRI</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Rek Tujuan</span>
                    <span class="info-value">0048-01-027309-50-8</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Atas Nama</span>
                    <span class="info-value">SMK KRISTEN 2 MAGELANG</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Jumlah Transfer</span>
                    <span class="info-value">Rp1.000.000</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Status</span>
                    <div class="info-value">
                      <span class="badge bg-danger px-3 py-2">Reject by Admin</span>
                      <p class="text-danger small mt-1 mb-0">
                        Kesalahan Penulisan, seharusnya <span class="fw-semibold">SPP/Bulan</span>
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer justify-content-center">
            <a href="transfer_beasiswa.html" type="button" class="btn btn-warning text-white px-4 fw-bold">
              <i class="bi bi-pencil-square me-1"></i> Edit
            </a>
            <button type="button" class="btn btn-primary px-4 fw-bold" data-bs-dismiss="modal">
              <i class="bi bi-arrow-left me-1"></i> Kembali
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/style.js"></script>
    <script src="../assets/js/datatable.init.js"></script>
    <!-- jQuery (dibutuhkan oleh DataTables) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <script>
      // ===============================
      // Data Lists
      // ===============================
      const tingkatSekolahList = ['SD', 'SMP', 'SMA'];
      const statusList = ['Naik Kelas', 'Tidak Naik Kelas'];
      const statusSppList = ['Aktif', 'Tidak Aktif'];

      // ===============================
      // Generate Data Anak Asuh
      // ===============================
      const anakAsuhData = Array.from({ length: 30 }, (_, i) => {
        const tingkat = tingkatSekolahList[Math.floor(Math.random() * tingkatSekolahList.length)];
        const sppTahunIni = Math.floor(Math.random() * 3000000) + 500000;

        return {
          no: i + 1,
          id: `AAS-${String(i + 1).padStart(4, '0')}`,
          nama: `Anak Asuh ${i + 1}`,
          komunitasSekolah: `Sekolah ${tingkat} ${i + 1}`,
          kelas: `${tingkat} Kelas ${Math.floor(Math.random() * 6) + 1}`,
          status: statusList[Math.floor(Math.random() * statusList.length)],
          sppTahunIni,
          statusSpp: statusSppList[Math.floor(Math.random() * statusSppList.length)],
          donatur: `Donatur ${i + 1}`,
        };
      });

      // ===============================
      // Populate Sekolah Filter
      // ===============================
      const sekolahFilter = document.getElementById('sekolahFilter');
      const uniqueSekolah = [...new Set(anakAsuhData.map(s => s.komunitasSekolah))];
      uniqueSekolah.forEach(sekolah => {
        const option = document.createElement('option');
        option.value = sekolah;
        option.textContent = sekolah;
        sekolahFilter.appendChild(option);
      });

      // ===============================
      // Filter Variables
      // ===============================
      let currentFilters = {
        sekolah: '',
        status: '',
        tingkat: '',
      };

      const tableBody = document.querySelector('#datatable tbody');
      const cardList = document.getElementById('cardList');
      const searchCard = document.getElementById('searchCard');
      const paginationMobile = document.getElementById('paginationMobile');

      let currentPageMobile = 1;
      const perPageMobile = 6;

      // ===============================
      // Helper: Warna badge status
      // ===============================
      function getStatusBadgeClass(status) {
        return status === 'Naik Kelas' ? 'success' : 'secondary';
      }

      // ===============================
      // Helper: Warna badge status SPP
      // ===============================
      function getStatusSppBadgeClass(statusSpp) {
        return statusSpp === 'Aktif' ? 'success' : 'warning';
      }

      // ===============================
      // Render Tabel (Desktop)
      // ===============================
      function renderTable() {
        const filteredData = anakAsuhData.filter(s => {
          const matchesSekolah = !currentFilters.sekolah || s.komunitasSekolah === currentFilters.sekolah;
          const matchesStatus = !currentFilters.status || s.status === currentFilters.status;
          const matchesTingkat = !currentFilters.tingkat || s.kelas.startsWith(currentFilters.tingkat);
          return matchesSekolah && matchesStatus && matchesTingkat;
        });

        tableBody.innerHTML = filteredData
          .map(
            s => `
      <tr onclick="window.location.href='lap_detail_anakasuh.html'">
        <td>${s.no}</td>
        <td>${s.id}</td>
        <td>${s.nama}</td>
        <td>${s.komunitasSekolah}</td>
        <td>${s.kelas}</td>
        <td><span class="badge bg-${getStatusBadgeClass(s.status)}">${s.status}</span></td>
        <td>Rp${s.sppTahunIni.toLocaleString('id-ID')}</td>
        <td><span class="badge bg-${getStatusSppBadgeClass(s.statusSpp)}">${s.statusSpp}</span></td>
        <td>${s.donatur}</td>
      </tr>
    `
          )
          .join('');
      }

      // ===============================
      // Render Cards (Mobile)
      // ===============================
      function renderCards() {
        const searchTerm = searchCard.value.toLowerCase();

        let filtered = anakAsuhData.filter(
          s =>
            s.id.toLowerCase().includes(searchTerm) ||
            s.nama.toLowerCase().includes(searchTerm) ||
            s.komunitasSekolah.toLowerCase().includes(searchTerm) ||
            s.kelas.toLowerCase().includes(searchTerm) ||
            s.status.toLowerCase().includes(searchTerm) ||
            s.donatur.toLowerCase().includes(searchTerm)
        );

        // Apply additional filters
        filtered = filtered.filter(s => {
          const matchesSekolah = !currentFilters.sekolah || s.komunitasSekolah === currentFilters.sekolah;
          const matchesStatus = !currentFilters.status || s.status === currentFilters.status;
          const matchesTingkat = !currentFilters.tingkat || s.kelas.startsWith(currentFilters.tingkat);
          return matchesSekolah && matchesStatus && matchesTingkat;
        });

        const totalPages = Math.ceil(filtered.length / perPageMobile);
        if (currentPageMobile > totalPages) currentPageMobile = totalPages || 1;

        const start = (currentPageMobile - 1) * perPageMobile;
        const paginated = filtered.slice(start, start + perPageMobile);

        cardList.innerHTML = paginated
          .map(
            s => `
      <div class="col-12">
        <div class="card shadow-sm p-3 mb-2">
          <h5 class="card-title">${s.nama}</h5>
          <p class="mb-1"><strong>ID:</strong> ${s.id}</p>
          <p class="mb-1"><strong>Komunitas/Sekolah:</strong> ${s.komunitasSekolah}</p>
          <p class="mb-1"><strong>Kelas:</strong> ${s.kelas}</p>
          <p class="mb-1"><strong>Status:</strong> <span class="badge bg-${getStatusBadgeClass(s.status)}">${
              s.status
            }</span></p>
          <p class="mb-1"><strong>SPP Tahun Ajaran Ini:</strong> Rp${s.sppTahunIni.toLocaleString('id-ID')}</p>
          <p class="mb-1"><strong>Status SPP:</strong> <span class="badge bg-${getStatusSppBadgeClass(s.statusSpp)}">${
              s.statusSpp
            }</span></p>
          <p class="mb-1"><strong>Donatur:</strong> ${s.donatur}</p>
        </div>
      </div>
    `
          )
          .join('');

        // Pagination
        paginationMobile.innerHTML =
          totalPages > 1
            ? Array.from(
                { length: totalPages },
                (_, i) => `
            <li class="page-item ${i + 1 === currentPageMobile ? 'active' : ''}">
              <a class="page-link" href="#" data-page="${i + 1}">${i + 1}</a>
            </li>
          `
              ).join('')
            : '';

        paginationMobile.querySelectorAll('.page-link').forEach(link => {
          link.addEventListener('click', e => {
            e.preventDefault();
            const page = parseInt(e.target.dataset.page);
            if (page && page !== currentPageMobile) {
              currentPageMobile = page;
              renderCards();
            }
          });
        });
      }

      // ===============================
      // Event Listener
      // ===============================
      searchCard.addEventListener('input', () => {
        currentPageMobile = 1;
        renderCards();
      });

      // Add event listeners for filters
      document.getElementById('sekolahFilter').addEventListener('change', e => {
        currentFilters.sekolah = e.target.value;
        renderTable();
        renderCards();
      });

      document.getElementById('statusFilter').addEventListener('change', e => {
        currentFilters.status = e.target.value;
        renderTable();
        renderCards();
      });

      document.getElementById('tingkatFilter').addEventListener('change', e => {
        currentFilters.tingkat = e.target.value;
        renderTable();
        renderCards();
      });

      // ===============================
      // Inisialisasi Awal
      // ===============================
      renderTable();
      renderCards();
    </script>
  </body>
</html>
